---
name: 'build-and-push-to-github'
description: 'Build and push a Docker Image'
inputs:
  image-name: 
    description: 'Image to build and push'
    required: true
  username:
    description: 'Username to login to Github registry'
  password:
    description: 'Token to login to Github Registry'

runs:
  using: "composite"
  env:
    DOCKER_REGISTRY: ghcr.io
  steps:
    - name: Login to GHCR 
      run: |
        docker login ${{ env.DOCKER_REGISTRY }} -u ${{ inputs.username }} -p ${{ inputs.password }}
      shell: bash

    - name: Docker build
      run: |
        docker build -t ${{ env.DOCKER_REGISTRY }}/kuent1/buildandpush/${{ inputs.image-name }} .
      shell: bash